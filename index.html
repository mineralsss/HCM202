<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChuyÃªn Ä‘á»: Äáº¡i Ä‘oÃ n káº¿t dÃ¢n tá»™c â€“ TÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh</title>
  <meta name="description" content="Trang há»c liá»‡u ChÆ°Æ¡ng 5: Äáº¡i Ä‘oÃ n káº¿t toÃ n dÃ¢n tá»™c & Ä‘oÃ n káº¿t quá»‘c táº¿ â€“ TÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh. CÃ³ má»¥c lá»¥c tá»± Ä‘á»™ng, tÃ¬m kiáº¿m, chá»‰nh sá»­a inline, in PDF." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1020; --panel:#121936; --card:#0e1330; --muted:#94a3b8; --text:#e6eaf2;
      --brand:#6ea8fe; --acc:#8bafff; --ok:#22c55e; --warn:#f59e0b; --err:#ef4444;
      --br:16px; --line:rgba(148,163,184,.2);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{position:sticky;top:0;background:linear-gradient(180deg,var(--bg),rgba(11,16,32,.6));backdrop-filter:blur(8px);z-index:50;border-bottom:1px solid var(--line)}
    .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:14px 0}
    .brand{display:flex;gap:10px;align-items:center}
    .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--acc));display:grid;place-items:center;color:#0b1020;font-weight:800}
    .brand h1{font-size:18px;margin:0}
    .actions{display:flex;gap:10px;align-items:center}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:var(--panel);color:var(--text);cursor:pointer}
    .btn:hover{border-color:var(--brand)}
    .btn.primary{background:linear-gradient(180deg,var(--acc),var(--brand));color:#0b1020;border:0}

    main{display:grid;grid-template-columns:280px 1fr;gap:24px;margin-top:16px}
    @media (max-width:960px){ main{grid-template-columns:1fr} .toc{position:static; top:auto; } }

    .card{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border:1px solid var(--line);border-radius:var(--br)}
    .hero{padding:18px}
    .hero h2{margin:0 0 6px;font-size:22px}
    .hero p{margin:0;color:var(--muted)}
    .meta{display:flex;gap:12px;flex-wrap:wrap;color:var(--muted);font-size:14px}

    .toc{position:sticky;top:76px;height:calc(100dvh - 96px);overflow:auto;padding:14px}
    .toc h3{margin:8px 0 10px;font-size:14px;color:var(--muted)}
    .toc a{display:block;padding:8px 10px;border-radius:10px}
    .toc a.active{background:rgba(110,168,254,.12)}

    .paper{padding:18px}
    .paper h2{margin-top:0}
    section{padding:14px 10px;border-top:1px dashed var(--line)}
    section:first-of-type{border-top:0}
    h3{margin:8px 0}
    h4{margin:8px 0;color:#c7d2fe}
    .quote{padding:14px 16px;border-left:4px solid var(--brand);background:rgba(110,168,254,.08);border-radius:8px}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap;padding:12px}
    .search{flex:1;min-width:240px;display:flex;gap:8px}
    .search input{flex:1;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:var(--card);color:var(--text)}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border:1px solid var(--line);border-radius:999px;background:var(--card);font-size:12px}
    mark{background:rgba(110,168,254,.35);padding:2px 4px;border-radius:6px}
    .foot{margin-top:24px;padding:18px;color:var(--muted);border-top:1px solid var(--line)}
    .small{font-size:13px;color:var(--muted)}

    /* --- Banner --- */
    .banner{position:relative;margin:16px 0;border-radius:16px;overflow:hidden;border:1px solid var(--line);box-shadow:0 18px 40px rgba(0,0,0,.25)}
    .banner img{display:block;width:100%;height:320px;object-fit:cover;filter:saturate(1.05)}
    .banner::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.25),rgba(0,0,0,.55))}
    .banner .cap{position:absolute;left:20px;bottom:16px;color:#fff;font-weight:600;letter-spacing:.2px}
    .banner .cap .sub{display:block;font-weight:500;opacity:.9;font-size:14px}

    /* --- Gallery --- */
    .gallery{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;margin-top:10px}
    .gallery .fig{grid-column:span 12;background:var(--card);border:1px solid var(--line);border-radius:14px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    @media(min-width:700px){.gallery .fig{grid-column:span 6}}
    @media(min-width:1040px){.gallery .fig{grid-column:span 4}}
    .fig img{display:block;width:100%;height:220px;object-fit:cover}
    .fig figcaption{padding:10px 12px;color:var(--muted);font-size:13px;border-top:1px solid var(--line)}

    /* --- Lightbox --- */
    .lb{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:9999}
    .lb.open{display:flex}
    .lb-inner{max-width:min(1100px,92vw);max-height:88vh}
    .lb-inner img{width:100%;height:auto;border-radius:12px}
    .lb .close{position:absolute;top:16px;right:16px;background:#0008;border:1px solid #fff3;color:#fff;padding:8px 10px;border-radius:10px;cursor:pointer}
    .lb .caption{position:absolute;left:50%;bottom:20px;transform:translateX(-50%);color:#fff;background:#0008;padding:8px 12px;border-radius:10px;font-size:14px;max-width:80vw}
  </style>
</head>
<body>
  <header>
    <div class="container topbar">
      <div class="brand">
        <div class="logo">H5</div>
        <h1>TÆ° tÆ°á»Ÿng HCM â€“ ChÆ°Æ¡ng 5</h1>
      </div>
      <div class="actions">
        <button class="btn" id="btnPrint" title="In / Xuáº¥t PDF">ğŸ–¨ï¸ In</button>
        <button class="btn" id="btnCopyLink" title="Sao chÃ©p liÃªn káº¿t má»¥c hiá»‡n táº¡i">ğŸ”— Copy má»¥c</button>
        <button class="btn primary" id="btnEdit" title="Báº­t chá»‰nh sá»­a inline">âœï¸ Chá»‰nh sá»­a</button>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="card hero">
      <div class="meta">
        <div>ğŸ“š Há»c pháº§n: TÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh</div>
        <div>ğŸ§© Chá»§ Ä‘á»: Äáº¡i Ä‘oÃ n káº¿t toÃ n dÃ¢n tá»™c & Ä‘oÃ n káº¿t quá»‘c táº¿</div>
        <div>ğŸ—“ï¸ Cáº­p nháº­t: <span id="lastUpdated"></span></div>
      </div>
      <h2>Äáº·t váº¥n Ä‘á» / cÃ¢u há»i kiáº¿n táº¡o</h2>
      <p id="problem">
        Trong lá»‹ch sá»­, nhiá»u phong trÃ o cÃ¡ch máº¡ng tá»«ng kÃªu gá»i Ä‘oÃ n káº¿t nhÆ°ng chá»‰ dá»«ng láº¡i á»Ÿ má»©c táº¡m thá»i, khi Ä‘áº¡t má»¥c tiÃªu thÃ¬ khá»‘i Ä‘oÃ n káº¿t tan rÃ£.
        Há»“ ChÃ­ Minh kháº³ng Ä‘á»‹nh: â€œÄoÃ n káº¿t lÃ  then chá»‘t cá»§a thÃ nh cÃ´ngâ€ vÃ  coi Ä‘Ã³ lÃ  chiáº¿n lÆ°á»£c xuyÃªn suá»‘t.
        <strong>Váº­y Ä‘oÃ n káº¿t dÃ¢n tá»™c</strong> trong tÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh lÃ  <em>sÃ¡ch lÆ°á»£c tÃ¬nh tháº¿</em> hay lÃ  <em>chiáº¿n lÆ°á»£c mang tÃ­nh sá»‘ng cÃ²n</em>?
      </p>
      <div class="quote small">ğŸ’¡ Gá»£i Ã½: Tráº£ lá»i báº±ng cÃ¡ch trÃ¬nh bÃ y há»‡ thá»‘ng luáº­n Ä‘iá»ƒm â€“ luáº­n cá»© â€“ dáº«n chá»©ng lá»‹ch sá»­ â€“ váº­n dá»¥ng hiá»‡n nay.</div>
      <div class="toolbar">
        <div class="search">
          <input id="searchBox" placeholder="TÃ¬m nhanh trong trang (vÃ­ dá»¥: 'Máº·t tráº­n')" />
          <button class="btn" id="btnFind">ğŸ” TÃ¬m</button>
        </div>
        <span class="chip">âŒ˜/Ctrl + F: tÃ¬m trÃ¬nh duyá»‡t</span>
        <span class="chip">S: báº­t chá»‰nh sá»­a</span>
      </div>
    </div>

    <!-- Hero banner -->
    <div class="banner">
      <img src="images/doan-ket-lehoi.jpeg" alt="KhÃ´ng khÃ­ Ä‘oÃ n káº¿t toÃ n dÃ¢n trong ngÃ y há»™i lá»›n"/>
      <div class="cap">Khá»‘i Ä‘áº¡i Ä‘oÃ n káº¿t toÃ n dÃ¢n tá»™c<span class="sub">Sá»©c máº¡nh vÃ´ Ä‘á»‹ch â€“ chÃ¬a khÃ³a cá»§a má»i tháº¯ng lá»£i</span></div>
    </div>

    <main>
      <nav class="card toc" id="toc">
        <h3>Má»¥c lá»¥c</h3>
        <!-- TOC items will be injected -->
      </nav>

      <article class="card paper" id="paper" contenteditable="false">
        <h2 id="chuong5">ChÆ°Æ¡ng 5: TÆ° tÆ°á»Ÿng HCM vá» Ä‘áº¡i Ä‘oÃ n káº¿t toÃ n dÃ¢n tá»™c & Ä‘oÃ n káº¿t quá»‘c táº¿</h2>

        <section id="5-1">
          <h3>5.1. Äáº¡i Ä‘oÃ n káº¿t toÃ n dÃ¢n tá»™c</h3>
          <h4 id="5-1-1">5.1.1. Vai trÃ²</h4>
          <p>Äáº¡i Ä‘oÃ n káº¿t lÃ  váº¥n Ä‘á» mang <em>Ã½ nghÄ©a chiáº¿n lÆ°á»£c</em>, quyáº¿t Ä‘á»‹nh thÃ nh cÃ´ng cá»§a cÃ¡ch máº¡ng: lÃ  <strong>sá»©c máº¡nh vÃ´ Ä‘á»‹ch</strong>, lÃ  <strong>chÃ¬a khÃ³a then chá»‘t</strong> cá»§a má»i tháº¯ng lá»£i, lÃ  <strong>má»¥c tiÃªu & nhiá»‡m vá»¥ hÃ ng Ä‘áº§u</strong> cáº§n quÃ¡n triá»‡t.</p>
          <ul>
            <li>ChÃ¢n lÃ½: â€œÄoÃ n káº¿t, Ä‘oÃ n káº¿t, Ä‘áº¡i Ä‘oÃ n káº¿t. ThÃ nh cÃ´ng, thÃ nh cÃ´ng, Ä‘áº¡i thÃ nh cÃ´ngâ€.</li>
            <li>Má»¥c tiÃªu: â€œMá»™t nÆ°á»›c Viá»‡t Nam hÃ²a bÃ¬nh, thá»‘ng nháº¥t, Ä‘á»™c láº­p, dÃ¢n chá»§ vÃ  giÃ u máº¡nhâ€¦â€.</li>
          </ul>

          <h4 id="5-1-2">5.1.2. Lá»±c lÆ°á»£ng</h4>
          <p><strong>Chá»§ thá»ƒ:</strong> toÃ n thá»ƒ dÃ¢n tá»™c Viá»‡t Nam; khÃ´ng phÃ¢n biá»‡t giai cáº¥p, tÃ´n giÃ¡o, dÃ¢n tá»™c, nghá» nghiá»‡pâ€¦ miá»…n lÃ  cÃ¹ng phá»¥ng sá»± Tá»• quá»‘c.</p>
          <p><strong>Ná»n táº£ng:</strong> liÃªn minh <em>cÃ´ng â€“ nÃ´ng â€“ trÃ­ thá»©c</em> dÆ°á»›i sá»± lÃ£nh Ä‘áº¡o cá»§a Äáº£ng; cá»§ng cá»‘ cháº·t cháº½ Ä‘á»ƒ báº£o Ä‘áº£m bá»n vá»¯ng khá»‘i Ä‘oÃ n káº¿t.</p>

          <h4 id="5-1-3">5.1.3. Äiá»u kiá»‡n xÃ¢y dá»±ng</h4>
          <ol>
            <li>Káº¿t há»£p lá»£i Ã­ch chung â€“ riÃªng; Ä‘áº·t lá»£i Ã­ch dÃ¢n tá»™c lÃªn trÃªn háº¿t.</li>
            <li>Káº¿ thá»«a truyá»n thá»‘ng yÃªu nÆ°á»›c, nhÃ¢n nghÄ©a, Ä‘oÃ n káº¿t.</li>
            <li>Khoan dung, Ä‘á»™ lÆ°á»£ng; â€œcáº§u Ä‘á»“ng tá»“n dá»‹â€.</li>
            <li>XÃ¢y dá»±ng niá»m tin cá»§a nhÃ¢n dÃ¢n: dÃ¢n tin â€“ dÃ¢n yÃªu â€“ dÃ¢n kÃ­nh.</li>
          </ol>

          <h4 id="5-1-4">5.1.4. HÃ¬nh thá»©c & nguyÃªn táº¯c â€“ Máº·t tráº­n dÃ¢n tá»™c thá»‘ng nháº¥t</h4>
          <p><strong>HÃ¬nh thá»©c:</strong> Máº·t tráº­n dÃ¢n tá»™c thá»‘ng nháº¥t â€“ ngÃ´i nhÃ  chung cá»§a má»i ngÆ°á»i Viá»‡t Nam (Viá»‡t Minh, LiÃªn Viá»‡t, Máº·t tráº­n Tá»• quá»‘câ€¦).</p>
          <p><strong>NguyÃªn táº¯c:</strong> (1) Ná»n táº£ng liÃªn minh cÃ´ngâ€“nÃ´ngâ€“trÃ­ thá»©c dÆ°á»›i sá»± lÃ£nh Ä‘áº¡o cá»§a Äáº£ng; (2) Hiá»‡p thÆ°Æ¡ng dÃ¢n chá»§; (3) ÄoÃ n káº¿t lÃ¢u dÃ i, chÃ¢n thÃ nh, cÃ¹ng tiáº¿n bá»™.</p>

          <h4 id="5-1-5">5.1.5. PhÆ°Æ¡ng thá»©c</h4>
          <p><strong>DÃ¢n váº­n</strong> lÃ  phÆ°Æ¡ng thá»©c cÆ¡ báº£n: tá»• chá»©c â€“ giÃ¡o dá»¥c â€“ phÃ¡t huy trÃ­ tuá»‡, sá»©c máº¡nh váº­t cháº¥t & tinh tháº§n cá»§a quáº§n chÃºng; xÃ¢y dá»±ng há»‡ thá»‘ng tá»• chá»©c quáº§n chÃºng (CÃ´ng Ä‘oÃ n, Há»™i NÃ´ng dÃ¢n, ÄoÃ n Thanh niÃªn, Há»™i Phá»¥ ná»¯â€¦) phá»‘i há»£p trong Máº·t tráº­n.</p>
        </section>

        <section id="lich-su-41-46">
          <h3>I. Chá»©ng minh lá»‹ch sá»­: 1941â€“1946</h3>
          <ul>
            <li><strong>1941:</strong> Há»“ ChÃ­ Minh vá» nÆ°á»›c, chá»§ trÃ¬ Há»™i nghá»‹ TW 8, xÃ¡c Ä‘á»‹nh nhiá»‡m vá»¥ giáº£i phÃ³ng dÃ¢n tá»™c; thÃ nh láº­p Viá»‡t Minh Ä‘á»ƒ Ä‘oÃ n káº¿t toÃ n dÃ¢n.</li>
            <li><strong>1945â€“1946:</strong> CÃ¡ch máº¡ng ThÃ¡ng TÃ¡m thÃ nh cÃ´ng; 2/9/1945 tuyÃªn ngÃ´n Ä‘á»™c láº­p; xÃ¢y dá»±ng chÃ­nh quyá»n non tráº»; 19/12/1946 lá»i kÃªu gá»i toÃ n quá»‘c khÃ¡ng chiáº¿n.</li>
          </ul>
        </section>

        <section id="lich-su-46-75">
          <h3>II. Chá»©ng minh lá»‹ch sá»­: 1946â€“1975</h3>
          <ul>
            <li>KhÃ¡ng chiáº¿n chá»‘ng PhÃ¡p (1946â€“1954); sau 1954, miá»n Báº¯c quÃ¡ Ä‘á»™ lÃªn CNXH; HCM phÃ¡t triá»ƒn quan Ä‘iá»ƒm vá» CNXH.</li>
            <li>Chá»‘ng Má»¹ cá»©u nÆ°á»›c (1954â€“1975): chÃ¢n lÃ½ â€œKhÃ´ng cÃ³ gÃ¬ quÃ½ hÆ¡n Ä‘á»™c láº­p, tá»± doâ€; káº¿t há»£p sá»©c máº¡nh dÃ¢n tá»™c â€“ thá»i Ä‘áº¡i â€“ Ä‘oÃ n káº¿t quá»‘c táº¿ â†’ thá»‘ng nháº¥t 1975.</li>
          </ul>
        </section>

        <section id="hien-dai-86-nay">
          <h3>III. Chá»©ng minh hiá»‡n Ä‘áº¡i: 1986 â€“ nay</h3>
          <ul>
            <li>Äá»•i má»›i (ÄH VI â€“ 1986); ÄH VII (1991) kháº³ng Ä‘á»‹nh TT HCM + CN MÃ¡câ€“LÃªnin lÃ  ná»n táº£ng.</li>
            <li>Tiáº¿p tá»¥c váº­n dá»¥ng: má»¥c tiÃªu dÃ¢n giÃ u, nÆ°á»›c máº¡nh, dÃ¢n chá»§, cÃ´ng báº±ng, vÄƒn minh; nháº¥n máº¡nh chiáº¿n lÆ°á»£c <em>Ä‘áº¡i Ä‘oÃ n káº¿t</em> vÃ  phÃ¡t triá»ƒn vÄƒn hÃ³a â€“ con ngÆ°á»i.</li>
          </ul>
          <p class="small">Tá»•ng káº¿t: TÆ° tÆ°á»Ÿng HCM vá» Ä‘áº¡i Ä‘oÃ n káº¿t lÃ  <strong>Ä‘Æ°á»ng lá»‘i chiáº¿n lÆ°á»£c</strong> xuyÃªn suá»‘t â€“ Ä‘á»™ng lá»±c & nguá»“n lá»±c Ä‘á»ƒ giÃ nh vÃ  giá»¯ Ä‘á»™c láº­p, xÃ¢y dá»±ng & báº£o vá»‡ Tá»• quá»‘c trong má»i thá»i ká»³.</p>
        </section>

        <section id="hinh-anh">
          <h3>HÃ¬nh áº£nh minh há»a</h3>
          <p class="small">áº¢nh minh há»a cho ná»™i dung ChÆ°Æ¡ng 5. Báº¥m áº£nh Ä‘á»ƒ phÃ³ng to. Thay áº£nh báº±ng cÃ¡ch Ä‘áº·t file trong thÆ° má»¥c <code>/images</code> Ä‘Ãºng tÃªn phÃ­a dÆ°á»›i.</p>
          <div class="gallery" id="gallery">
            <figure class="fig">
              <img loading="lazy" src="images/doan-ket-lehoi.jpeg" alt="KhÃ´ng khÃ­ Ä‘oÃ n káº¿t toÃ n dÃ¢n â€“ lá»… diá»…u hÃ nh">
              <figcaption>KhÃ´ng khÃ­ Ä‘oÃ n káº¿t toÃ n dÃ¢n â€“ sáº¯c mÃ u cÃ¡c dÃ¢n tá»™c cÃ¹ng cá» Tá»• quá»‘c.</figcaption>
            </figure>
            <figure class="fig">
              <img loading="lazy" src="images/bac-ho-dan-toc.jpg" alt="Chá»§ tá»‹ch Há»“ ChÃ­ Minh vá»›i Ä‘á»“ng bÃ o cÃ¡c dÃ¢n tá»™c">
              <figcaption>Chá»§ tá»‹ch Há»“ ChÃ­ Minh vá»›i Ä‘á»“ng bÃ o cÃ¡c dÃ¢n tá»™c â€“ biá»ƒu tÆ°á»£ng cá»§a khá»‘i Ä‘áº¡i Ä‘oÃ n káº¿t.</figcaption>
            </figure>
            <figure class="fig">
              <img loading="lazy" src="images/bac-ho-giua-nhan-dan.jpg" alt="BÃ¡c Há»“ giá»¯a biá»ƒn ngÆ°á»i">
              <figcaption>BÃ¡c Há»“ giá»¯a biá»ƒn ngÆ°á»i: â€œDÃ¢n lÃ  gá»‘câ€ â€“ niá»m tin lÃ  ná»n táº£ng cá»§a Ä‘oÃ n káº¿t.</figcaption>
            </figure>
          </div>
        </section>
      </article>
    </main>

    <footer class="foot small">
      Â© 2025 NhÃ³m Há»c pháº§n HCM â€“ Single-file template. CÃ³ thá»ƒ deploy lÃªn Vercel/Netlify/GitHub Pages.
    </footer>
  </div>

  <script>
    // Helpers
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const $  = (sel, root=document) => root.querySelector(sel);

    // Cáº­p nháº­t thá»i gian
    const fmt = new Intl.DateTimeFormat('vi-VN', { dateStyle: 'medium', timeStyle: 'short' });
    $('#lastUpdated').textContent = fmt.format(new Date());

    // TOC auto-build
    function buildTOC(){
      const toc = $('#toc');
      toc.querySelectorAll('a').forEach(a=>a.remove());
      $$('#paper h2, #paper h3, #paper h4').forEach(h => {
        const id = h.id || h.textContent.toLowerCase().replace(/[^a-z0-9Ã -á»¹\s-]/gi,'').trim().replace(/\s+/g,'-');
        h.id = id;
        const a = document.createElement('a');
        a.href = `#${id}`;
        a.textContent = h.tagName === 'H2' ? `â˜… ${h.textContent}` : h.textContent;
        toc.appendChild(a);
      });
    }
    buildTOC();

    // Scrollspy
    function onScrollSpy(){
      const fromTop = window.scrollY + 120;
      const heads = $$('#paper h2, #paper h3, #paper h4');
      let currentId = heads[0]?.id;
      for(const h of heads){ if(h.offsetTop <= fromTop) currentId = h.id; else break; }
      $$('#toc a').forEach(a => a.classList.toggle('active', a.getAttribute('href') === `#${currentId}`));
    }
    document.addEventListener('scroll', onScrollSpy, {passive:true});

    // Print & Copy deep link
    $('#btnPrint').addEventListener('click', () => window.print());
    $('#btnCopyLink').addEventListener('click', () => {
      const active = $('#toc a.active') || $('#toc a');
      const url = new URL(location.href);
      if(active){ url.hash = active.getAttribute('href'); }
      navigator.clipboard.writeText(url.toString()).then(()=> toast('ÄÃ£ sao chÃ©p liÃªn káº¿t má»¥c hiá»‡n táº¡i.'));
    });

    // TÃ¬m kiáº¿m highlight
    $('#btnFind').addEventListener('click', () => highlight($('#searchBox').value.trim()));
    $('#searchBox').addEventListener('keydown', e=>{ if(e.key==='Enter') highlight(e.target.value.trim()); });
    function highlight(q){
      $$('#paper mark').forEach(m => { const t = document.createTextNode(m.textContent); m.replaceWith(t); });
      if(!q) return;
      const walker = document.createTreeWalker($('#paper'), NodeFilter.SHOW_TEXT, null);
      const re = new RegExp(q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'), 'gi');
      const nodes = [];
      while(walker.nextNode()) nodes.push(walker.currentNode);
      nodes.forEach(node => {
        const frag = document.createDocumentFragment();
        let lastIdx = 0; const text = node.nodeValue;
        text.replace(re, (match, idx) => {
          frag.appendChild(document.createTextNode(text.slice(lastIdx, idx)));
          const m = document.createElement('mark'); m.textContent = match; frag.appendChild(m);
          lastIdx = idx + match.length;
        });
        frag.appendChild(document.createTextNode(text.slice(lastIdx)));
        if(re.test(text)) node.parentNode.replaceChild(frag, node);
      });
      toast('ÄÃ£ Ä‘Ã¡nh dáº¥u káº¿t quáº£ tÃ¬m kiáº¿m.');
    }

    // Inline edit + LocalStorage
    const KEY = 'hcm-page-content';
    const article = $('#paper');
    const btnEdit = $('#btnEdit');
    const setEditable = (v) => { article.contentEditable = v; btnEdit.textContent = v ? 'ğŸ’¾ LÆ°u & Táº¯t sá»­a' : 'âœï¸ Chá»‰nh sá»­a'; };
    const saved = localStorage.getItem(KEY);
    if(saved){ article.innerHTML = saved; buildTOC(); }
    btnEdit.addEventListener('click', () => {
      const editing = article.isContentEditable;
      if(editing){
        localStorage.setItem(KEY, article.innerHTML);
        toast('ÄÃ£ lÆ°u ná»™i dung (LocalStorage).');
        setEditable(false);
        buildTOC();
      } else {
        setEditable(true); article.focus();
      }
    });
    document.addEventListener('keydown', (e)=>{ if(e.key.toLowerCase()==='s' && !e.metaKey && !e.ctrlKey){ e.preventDefault(); btnEdit.click(); }});

    function toast(msg){
      const t = document.createElement('div');
      t.textContent = msg;
      t.style.cssText = 'position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:#0b1020;padding:10px 14px;border:1px solid var(--line);border-radius:10px;z-index:9999';
      document.body.appendChild(t); setTimeout(()=>t.remove(), 1800);
    }

    // Lightbox
    const lb = document.createElement('div');
    lb.className = 'lb';
    lb.innerHTML = '<button class="close">âœ•</button><div class="lb-inner"><img alt=""/></div><div class="caption"></div>';
    document.body.appendChild(lb);
    const lbImg = lb.querySelector('img');
    const lbCap = lb.querySelector('.caption');
    lb.addEventListener('click', (e)=>{ if(e.target===lb || e.target.classList.contains('close')) lb.classList.remove('open'); });

    function enableLightbox(){
      $$('#gallery img').forEach(img=>{
        img.style.cursor = 'zoom-in';
        img.addEventListener('click', ()=>{
          lbImg.src = img.src; lbImg.alt = img.alt || '';
          const cap = img.closest('figure')?.querySelector('figcaption')?.textContent?.trim() || '';
          lbCap.textContent = cap; lb.classList.add('open');
        });
      });
    }
    enableLightbox();
    new MutationObserver(()=> enableLightbox()).observe(document.getElementById('paper'), { subtree:true, childList:true });
  </script>

  <style media="print">
    header, .toc, .btn, .toolbar, .foot, #btnPrint, #btnEdit, #btnCopyLink { display: none !important; }
    main{ grid-template-columns:1fr; }
    body{ background:#fff; color:#000 }
    .card{ border:0; background:#fff }
    a{ color:#000; text-decoration:none }
  </style>
</body>
</html>
